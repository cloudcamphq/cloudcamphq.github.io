{
    "componentChunkName": "component---src-templates-docs-tsx",
    "path": "/docs/tutorial",
    "result": {"data":{"allApiDocs":{"nodes":[{"kind":"interface","name":"ARecordProps","docs":{"custom":{"order":null,"ignore":null}}},{"kind":"interface","name":"AaaaRecordProps","docs":{"custom":{"order":null,"ignore":null}}},{"kind":"interface","name":"AlarmConfiguration","docs":{"custom":{"order":null,"ignore":null}}},{"kind":"class","name":"App","docs":{"custom":{"order":"1","ignore":null}}},{"kind":"interface","name":"CNameRecordProps","docs":{"custom":{"order":null,"ignore":null}}},{"kind":"interface","name":"Configuration","docs":{"custom":{"order":null,"ignore":null}}},{"kind":"class","name":"Database","docs":{"custom":{"order":"5","ignore":null}}},{"kind":"interface","name":"DatabaseProps","docs":{"custom":{"order":null,"ignore":null}}},{"kind":"interface","name":"DatabaseVariables","docs":{"custom":{"order":null,"ignore":null}}},{"kind":"class","name":"Domain","docs":{"custom":{"order":"6","ignore":null}}},{"kind":"interface","name":"DomainProps","docs":{"custom":{"order":null,"ignore":null}}},{"kind":"enum","name":"LanguageCode","docs":{"custom":{"order":null,"ignore":null}}},{"kind":"interface","name":"MetricScalingProps","docs":{"custom":{"order":null,"ignore":null}}},{"kind":"interface","name":"MxRecordProps","docs":{"custom":{"order":null,"ignore":null}}},{"kind":"class","name":"PipelineStack","docs":{"custom":{"order":null,"ignore":"true"}}},{"kind":"interface","name":"PipelineStackProps","docs":{"custom":{"order":null,"ignore":null}}},{"kind":"class","name":"Ref","docs":{"custom":{"order":null,"ignore":null}}},{"kind":"interface","name":"RefParameterProps","docs":{"custom":{"order":null,"ignore":null}}},{"kind":"enum","name":"RepositoryHost","docs":{"custom":{"order":null,"ignore":null}}},{"kind":"interface","name":"ScalingSchedule","docs":{"custom":{"order":null,"ignore":null}}},{"kind":"interface","name":"ScheduleScalingProps","docs":{"custom":{"order":null,"ignore":null}}},{"kind":"interface","name":"SlackConfiguration","docs":{"custom":{"order":null,"ignore":null}}},{"kind":"class","name":"Stack","docs":{"custom":{"order":"2","ignore":null}}},{"kind":"class","name":"Stage","docs":{"custom":{"order":"3","ignore":null}}},{"kind":"interface","name":"TxtRecordProps","docs":{"custom":{"order":null,"ignore":null}}},{"kind":"class","name":"WebServer","docs":{"custom":{"order":"4","ignore":null}}},{"kind":"interface","name":"WebServerAlarmProps","docs":{"custom":{"order":null,"ignore":null}}},{"kind":"interface","name":"WebServerProps","docs":{"custom":{"order":null,"ignore":null}}}]},"allCommandDocs":{"nodes":[{"name":"deploy","order":"2","group":"deploy"},{"name":"status","order":"3","group":"status"},{"name":"cert:create","order":"5","group":"cert"},{"name":"cert:delete","order":"5","group":"cert"},{"name":"cert:index","order":"5","group":"cert"},{"name":"domain:create","order":"4","group":"domain"},{"name":"domain:delete","order":"4","group":"domain"},{"name":"domain:index","order":"4","group":"domain"},{"name":"domain:list","order":"4","group":"domain"},{"name":"domain:show","order":"4","group":"domain"},{"name":"init:debug","order":"1","group":"init"},{"name":"init:index","order":"1","group":"init"}]},"allMarkdownRemark":{"nodes":[{"frontmatter":{"slug":"installation","title":"Installation","order":1,"category":"getting-started"}},{"frontmatter":{"slug":"internals","title":"Internals","order":100,"category":"operations-guide"}},{"frontmatter":{"slug":"new-app","title":"Creating an app","order":1,"category":"operations-guide"}},{"frontmatter":{"slug":"tutorial","title":"Tutorial","order":2,"category":"getting-started"}}]},"markdownRemark":{"frontmatter":{"category":"getting-started","order":2,"slug":"tutorial","title":"Tutorial"},"headings":[{"value":"Clone the tutorial repo"},{"value":"Setting up camp"},{"value":"Deploying to AWS"},{"value":"Infrastructure as Code"},{"value":"Making Changes"},{"value":"Setting up monitoring"},{"value":"Custom domain (Optional)"},{"value":"Cleaning up"}],"html":"<p>This tutorial will walk you through build and deploying an application with\nCloudCamp. Make sure that <a href=\"/docs/installation/#installing-cloudcamp\">CloudCamp is\ninstalled</a> and your <a href=\"/docs/installation/#aws-setup\">AWS account is\nconfigured</a>.</p>\n<h1>Clone the tutorial repo</h1>\n<p>The easiest way to get started is to fork <a\nhref=\"https://github.com/cloudcamphq/tutorial\" target=\"_blank\"> the tutorial\nrepository</a> and then clone it:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">$ <span class=\"token function\">git</span> clone git@github.com:YOUR-USERNAME/tutorial.git <span class=\"token operator\">&amp;&amp;</span> <span class=\"token builtin class-name\">cd</span> tutorial</code></pre></div>\n<h1>Setting up camp</h1>\n<p>To add CloudCamp to your project, run <code class=\"language-text\">camp init</code>:</p>\n<div class=\"gatsby-highlight\" data-language=\"ts\">\n  <pre class=\"ts language-ts\"><code class=\"ts language-ts\">$ camp init --dockerfile=Dockerfile --language=typescript</code></pre>\n</div>\n<div class=\"gatsby-highlight\" data-language=\"javascript\">\n  <pre class=\"javascript language-javascript\"><code class=\"javascript language-javascript\">$ camp init --dockerfile=Dockerfile --language=javascript</code></pre>\n</div>\n<div class=\"gatsby-highlight\" data-language=\"python\">\n  <pre class=\"python language-python\"><code class=\"python language-python\">$ camp init --dockerfile=Dockerfile --language=python</code></pre>\n</div>\n<div class=\"gatsby-highlight\" data-language=\"csharp\">\n  <pre class=\"csharp language-csharp\"><code class=\"csharp language-csharp\">$ camp init --dockerfile=Dockerfile --language=csharp</code></pre>\n</div>\n<div class=\"gatsby-highlight\" data-language=\"java\">\n  <pre class=\"java language-java\"><code class=\"java language-java\">$ camp init --dockerfile=Dockerfile --language=java</code></pre>\n</div>\n<p>Note that passing a Dockerfile is optional - doing so will simply add a small\npiece of code that builds and runs a web service based on its contents.</p>\n<p>You now have a new directory called <code class=\"language-text\">cloudcamp</code> which contains all the files needed to deploy your app.</p>\n<h1>Deploying to AWS</h1>\n<p>Now let's deploy:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">$ camp deploy</code></pre></div>\n<p>Follow the on screen instructions to connect your GitHub account (the secret token will be stored in your own AWS account).</p>\n<p>TODO this needs to explain what is really going on (build pipeline)\n\"Once the command has finished, your app will be built and deployed.\"</p>\n<p>You can run <code class=\"language-text\">camp status</code> to watch the progress:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">$ camp status --wait --notify</code></pre></div>\n<p>Once finished, status will print the the URL of our web server. You can copy and paste the\nURL in your browser to verify everything is working.</p>\n<p>So far, we have:</p>\n<ul>\n<li>\n<p>a build pipeline that deploys your app on <code class=\"language-text\">git push</code>.</p>\n</li>\n<li>\n<p>a load balanced, scalable web service.</p>\n</li>\n</ul>\n<h1>Infrastructure as Code</h1>\n<p>CloudCamp is based on <em>Amazon Cloud Development Kit (CDK)</em>, a declarative way of\nbuilding infrastructure. Instead of imperatively creating and updating\nresources, we declare the state of what our infrastructure should look like. CDK\nthen takes care of making the necessary changes to accomplish our desired state.</p>\n<p>Open up <code class=\"language-text\" data-language=\"ts\">src/camp.ts</code><code class=\"language-text\" data-language=\"javascript\">src/camp.js</code><code class=\"language-text\" data-language=\"python\">src/camp.py</code><code class=\"language-text\" data-language=\"java\">src/Camp.java</code><code class=\"language-text\" data-language=\"csharp\">src/Camp.cs</code> in your camp's directory and take a look.</p>\n<div class=\"gatsby-highlight\" data-language=\"ts\"><pre class=\"ts language-ts\"><code class=\"ts language-ts\"><span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> App<span class=\"token punctuation\">,</span> WebServer <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"@cloudcamp/aws-runtime\"</span><span class=\"token punctuation\">;</span>\n&nbsp;\n<span class=\"token keyword\">const</span> app <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">App</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n&nbsp;\n<span class=\"token keyword\">const</span> web <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">WebServer</span><span class=\"token punctuation\">(</span>app<span class=\"token punctuation\">.</span>production<span class=\"token punctuation\">,</span> <span class=\"token string\">\"web\"</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span>\n  dockerfile<span class=\"token operator\">:</span> <span class=\"token string\">\"../../Dockerfile\"</span><span class=\"token punctuation\">,</span>\n  port<span class=\"token operator\">:</span> <span class=\"token number\">3000</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div><div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"javascript language-javascript\"><code class=\"javascript language-javascript\"><span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> App<span class=\"token punctuation\">,</span> WebServer <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"@cloudcamp/aws-runtime\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n&nbsp;\n<span class=\"token keyword\">const</span> app <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">App</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n&nbsp;\n<span class=\"token keyword\">const</span> web <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">WebServer</span><span class=\"token punctuation\">(</span>app<span class=\"token punctuation\">.</span>production<span class=\"token punctuation\">,</span> <span class=\"token string\">\"web\"</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span>\n  dockerfile<span class=\"token operator\">:</span> <span class=\"token string\">\"../../Dockerfile\"</span><span class=\"token punctuation\">,</span>\n  port<span class=\"token operator\">:</span> <span class=\"token number\">3000</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div><div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"python language-python\"><code class=\"python language-python\"><span class=\"token keyword\">from</span> cloudcamp<span class=\"token punctuation\">.</span>aws_runtime <span class=\"token keyword\">import</span> App<span class=\"token punctuation\">,</span> WebServer\n&nbsp;\napp <span class=\"token operator\">=</span> App<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n&nbsp;\nweb <span class=\"token operator\">=</span> WebServer<span class=\"token punctuation\">(</span>app<span class=\"token punctuation\">.</span>production<span class=\"token punctuation\">,</span> <span class=\"token string\">\"web\"</span><span class=\"token punctuation\">,</span>\n    dockerfile<span class=\"token operator\">=</span><span class=\"token string\">\"../../Dockerfile\"</span><span class=\"token punctuation\">,</span>\n    port<span class=\"token operator\">=</span><span class=\"token number\">3000</span>\n<span class=\"token punctuation\">)</span></code></pre></div><div class=\"gatsby-highlight\" data-language=\"csharp\"><pre class=\"csharp language-csharp\"><code class=\"csharp language-csharp\"><span class=\"token keyword\">using</span> <span class=\"token namespace\">Cloudcamp<span class=\"token punctuation\">.</span>Aws<span class=\"token punctuation\">.</span>Runtime</span><span class=\"token punctuation\">;</span>\n&nbsp;\n<span class=\"token class-name\">App</span> app <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token constructor-invocation class-name\">App</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n&nbsp;\n<span class=\"token class-name\">WebServer</span> web <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token constructor-invocation class-name\">WebServer</span><span class=\"token punctuation\">(</span>app<span class=\"token punctuation\">.</span>Production<span class=\"token punctuation\">,</span> <span class=\"token string\">\"web\"</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">new</span> <span class=\"token constructor-invocation class-name\">WebServerProps</span> <span class=\"token punctuation\">{</span>\n    Dockerfile <span class=\"token operator\">=</span> <span class=\"token string\">\"../../Dockerfile\"</span><span class=\"token punctuation\">,</span>\n    Port <span class=\"token operator\">=</span> <span class=\"token number\">3000</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div><div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"java language-java\"><code class=\"java language-java\"><span class=\"token keyword\">import</span> <span class=\"token namespace\">cloudcamp<span class=\"token punctuation\">.</span>aws<span class=\"token punctuation\">.</span>runtime<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">App</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token namespace\">cloudcamp<span class=\"token punctuation\">.</span>aws<span class=\"token punctuation\">.</span>runtime<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">WebServer</span><span class=\"token punctuation\">;</span>\n&nbsp;\n<span class=\"token class-name\">App</span> app <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">App</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n&nbsp;\n<span class=\"token class-name\">WebServer</span> web <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">WebServer</span><span class=\"token punctuation\">(</span>app<span class=\"token punctuation\">.</span><span class=\"token function\">getProduction</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"web\"</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">WebServerProps<span class=\"token punctuation\">.</span>Builder</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">.</span><span class=\"token function\">dockerfile</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"../../Dockerfile\"</span><span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">.</span><span class=\"token function\">port</span><span class=\"token punctuation\">(</span><span class=\"token number\">3000</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">build</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>In the beginning we instantiate the class <code class=\"language-text\">App</code> which stands\nfor an instance of our application running in the cloud.</p>\n<p>Next, we create a new <code class=\"language-text\">WebServer</code>, by passing in the stack it belongs to\n(<code class=\"language-text\">app.production</code>) and a unique identifier (<code class=\"language-text\">\"web\"</code>). Additionally, we pass a Dockerfile and a\nport so our web server knows what to run.</p>\n<h1>Making Changes</h1>\n<p>TODO add a database and monitoring at the same time</p>\n<p>To add a PostgreSQL database, change the code to look like this:</p>\n<div class=\"gatsby-highlight\" data-language=\"ts\"><pre class=\"ts language-ts\"><code class=\"ts language-ts\"><span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> App<span class=\"token punctuation\">,</span> WebServer<span class=\"token punctuation\">,</span> Database <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"@cloudcamp/aws-runtime\"</span><span class=\"token punctuation\">;</span>\n&nbsp;\n<span class=\"token keyword\">const</span> app <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">App</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n&nbsp;\n<span class=\"token keyword\">const</span> db <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Database</span><span class=\"token punctuation\">(</span>app<span class=\"token punctuation\">.</span>production<span class=\"token punctuation\">,</span> <span class=\"token string\">\"db\"</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span>\n  engine<span class=\"token operator\">:</span> <span class=\"token string\">\"postgres\"</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n&nbsp;\n<span class=\"token keyword\">const</span> web <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">WebServer</span><span class=\"token punctuation\">(</span>app<span class=\"token punctuation\">.</span>production<span class=\"token punctuation\">,</span> <span class=\"token string\">\"web\"</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span>\n  dockerfile<span class=\"token operator\">:</span> <span class=\"token string\">\"../../Dockerfile\"</span><span class=\"token punctuation\">,</span>\n  port<span class=\"token operator\">:</span> <span class=\"token number\">3000</span><span class=\"token punctuation\">,</span>\n  environment<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span> <span class=\"token constant\">DATABASE_URL</span><span class=\"token operator\">:</span> db<span class=\"token punctuation\">.</span>databaseUrl <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div><div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"javascript language-javascript\"><code class=\"javascript language-javascript\"><span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> App<span class=\"token punctuation\">,</span> WebServer<span class=\"token punctuation\">,</span> Database <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"@cloudcamp/aws-runtime\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n&nbsp;\n<span class=\"token keyword\">const</span> app <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">App</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n&nbsp;\n<span class=\"token keyword\">const</span> db <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Database</span><span class=\"token punctuation\">(</span>app<span class=\"token punctuation\">.</span>production<span class=\"token punctuation\">,</span> <span class=\"token string\">\"db\"</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span>\n  engine<span class=\"token operator\">:</span> <span class=\"token string\">\"postgres\"</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n&nbsp;\n<span class=\"token keyword\">const</span> web <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">WebServer</span><span class=\"token punctuation\">(</span>app<span class=\"token punctuation\">.</span>production<span class=\"token punctuation\">,</span> <span class=\"token string\">\"web\"</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span>\n  dockerfile<span class=\"token operator\">:</span> <span class=\"token string\">\"../../Dockerfile\"</span><span class=\"token punctuation\">,</span>\n  port<span class=\"token operator\">:</span> <span class=\"token number\">3000</span><span class=\"token punctuation\">,</span>\n  environment<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span> <span class=\"token constant\">DATABASE_URL</span><span class=\"token operator\">:</span> db<span class=\"token punctuation\">.</span>databaseUrl <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div><div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"python language-python\"><code class=\"python language-python\"><span class=\"token keyword\">from</span> cloudcamp<span class=\"token punctuation\">.</span>aws_runtime <span class=\"token keyword\">import</span> App<span class=\"token punctuation\">,</span> WebServer<span class=\"token punctuation\">,</span> Database\n&nbsp;\napp <span class=\"token operator\">=</span> App<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n&nbsp;\ndb <span class=\"token operator\">=</span> Database<span class=\"token punctuation\">(</span>app<span class=\"token punctuation\">.</span>production<span class=\"token punctuation\">,</span> <span class=\"token string\">\"db\"</span><span class=\"token punctuation\">,</span>\n    engine<span class=\"token operator\">=</span><span class=\"token string\">\"postgres\"</span>\n<span class=\"token punctuation\">)</span>\n&nbsp;\nweb <span class=\"token operator\">=</span> WebServer<span class=\"token punctuation\">(</span>app<span class=\"token punctuation\">.</span>production<span class=\"token punctuation\">,</span> <span class=\"token string\">\"web\"</span><span class=\"token punctuation\">,</span>\n    dockerfile<span class=\"token operator\">=</span><span class=\"token string\">\"../../Dockerfile\"</span><span class=\"token punctuation\">,</span>\n    port<span class=\"token operator\">=</span><span class=\"token number\">3000</span><span class=\"token punctuation\">,</span>\n    environment<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token string\">\"DATABASE_URL\"</span><span class=\"token punctuation\">:</span> db<span class=\"token punctuation\">.</span>database_url<span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">)</span></code></pre></div><div class=\"gatsby-highlight\" data-language=\"csharp\"><pre class=\"csharp language-csharp\"><code class=\"csharp language-csharp\"><span class=\"token keyword\">using</span> <span class=\"token namespace\">Cloudcamp<span class=\"token punctuation\">.</span>Aws<span class=\"token punctuation\">.</span>Runtime</span><span class=\"token punctuation\">;</span>\n&nbsp;\n<span class=\"token class-name\">App</span> app <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token constructor-invocation class-name\">App</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n&nbsp;\n<span class=\"token class-name\">Database</span> db <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token constructor-invocation class-name\">Database</span><span class=\"token punctuation\">(</span>app<span class=\"token punctuation\">.</span>Production<span class=\"token punctuation\">,</span> <span class=\"token string\">\"db\"</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">new</span> <span class=\"token constructor-invocation class-name\">DatabaseProps</span> <span class=\"token punctuation\">{</span>\n    Engine <span class=\"token operator\">=</span> <span class=\"token string\">\"postgres\"</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n&nbsp;\n<span class=\"token class-name\">WebServer</span> web <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token constructor-invocation class-name\">WebServer</span><span class=\"token punctuation\">(</span>app<span class=\"token punctuation\">.</span>Production<span class=\"token punctuation\">,</span> <span class=\"token string\">\"web\"</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">new</span> <span class=\"token constructor-invocation class-name\">WebServerProps</span> <span class=\"token punctuation\">{</span>\n    Dockerfile <span class=\"token operator\">=</span> <span class=\"token string\">\"../../Dockerfile\"</span><span class=\"token punctuation\">,</span>\n    Port <span class=\"token operator\">=</span> <span class=\"token number\">3000</span><span class=\"token punctuation\">,</span>\n    Environment <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token constructor-invocation class-name\">Dictionary<span class=\"token punctuation\">&lt;</span><span class=\"token keyword\">string</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">string</span><span class=\"token punctuation\">></span></span> <span class=\"token punctuation\">{</span> <span class=\"token punctuation\">{</span> <span class=\"token string\">\"DATABASE_URL\"</span><span class=\"token punctuation\">,</span> db<span class=\"token punctuation\">.</span>DatabaseUrl <span class=\"token punctuation\">}</span> <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div><div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"java language-java\"><code class=\"java language-java\"><span class=\"token keyword\">import</span> <span class=\"token namespace\">cloudcamp<span class=\"token punctuation\">.</span>aws<span class=\"token punctuation\">.</span>runtime<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">App</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token namespace\">cloudcamp<span class=\"token punctuation\">.</span>aws<span class=\"token punctuation\">.</span>runtime<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">WebServer</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token namespace\">cloudcamp<span class=\"token punctuation\">.</span>aws<span class=\"token punctuation\">.</span>runtime<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">Database</span><span class=\"token punctuation\">;</span>\n&nbsp;\n<span class=\"token class-name\">App</span> app <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">App</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n&nbsp;\n<span class=\"token class-name\">Database</span> db <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Database</span><span class=\"token punctuation\">(</span>app<span class=\"token punctuation\">.</span><span class=\"token function\">getProduction</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"db\"</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">DatabaseProps<span class=\"token punctuation\">.</span>Builder</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">.</span><span class=\"token function\">engine</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"postgres\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">build</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n&nbsp;\n<span class=\"token class-name\">WebServer</span> web <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">WebServer</span><span class=\"token punctuation\">(</span>app<span class=\"token punctuation\">.</span><span class=\"token function\">getProduction</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"web\"</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">WebServerProps<span class=\"token punctuation\">.</span>Builder</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">.</span><span class=\"token function\">dockerfile</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"../../Dockerfile\"</span><span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">.</span><span class=\"token function\">port</span><span class=\"token punctuation\">(</span><span class=\"token number\">3000</span><span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">.</span><span class=\"token function\">environment</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Map</span><span class=\"token punctuation\">.</span><span class=\"token function\">of</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"DATABASE_URL\"</span><span class=\"token punctuation\">,</span> db<span class=\"token punctuation\">.</span><span class=\"token function\">getDatabaseUrl</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">build</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>We create a database and add it to the production stack.\nThen we let the web server know about the database by adding the environment\nvariable <code class=\"language-text\">DATABASE_URL</code>.</p>\n<p>Push the code to apply this change and wait for the pipeline to complete:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">$ <span class=\"token function\">git</span> <span class=\"token function\">add</span> -A <span class=\"token operator\">&amp;&amp;</span> <span class=\"token function\">git</span> commit -m <span class=\"token string\">\"add database\"</span> <span class=\"token operator\">&amp;&amp;</span> <span class=\"token function\">git</span> push\n$ camp status --wait --notify</code></pre></div>\n<p>When refreshing our app in the browser it should now be connected to\nthe database.</p>\n<h1>Setting up monitoring</h1>\n<p>In a production app, we need to know when things goes wrong - for example, when\nusers encounter a server error. To simulate an error, visit the <code class=\"language-text\">/error</code> path on\nyour webserver. Now wouldn't it be nice if we got a notification whenever there\nis an error? The <code class=\"language-text\">WebServer</code> class provides an API for exactly that.</p>\n<p>Update your code to add error notifications:</p>\n<div class=\"gatsby-highlight\" data-language=\"ts\"><pre class=\"ts language-ts\"><code class=\"ts language-ts\"><span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> App<span class=\"token punctuation\">,</span> WebServer<span class=\"token punctuation\">,</span> Database <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"@cloudcamp/aws-runtime\"</span><span class=\"token punctuation\">;</span>\n&nbsp;\n<span class=\"token keyword\">const</span> app <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">App</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n&nbsp;\n<span class=\"token keyword\">const</span> db <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Database</span><span class=\"token punctuation\">(</span>app<span class=\"token punctuation\">.</span>production<span class=\"token punctuation\">,</span> <span class=\"token string\">\"db\"</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span>\n  engine<span class=\"token operator\">:</span> <span class=\"token string\">\"postgres\"</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n&nbsp;\n<span class=\"token keyword\">const</span> web <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">WebServer</span><span class=\"token punctuation\">(</span>app<span class=\"token punctuation\">.</span>production<span class=\"token punctuation\">,</span> <span class=\"token string\">\"web\"</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span>\n  dockerfile<span class=\"token operator\">:</span> <span class=\"token string\">\"../../Dockerfile\"</span><span class=\"token punctuation\">,</span>\n  port<span class=\"token operator\">:</span> <span class=\"token number\">3000</span><span class=\"token punctuation\">,</span>\n  environment<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span> <span class=\"token constant\">DATABASE_URL</span><span class=\"token operator\">:</span> db<span class=\"token punctuation\">.</span>databaseUrl <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n&nbsp;\nproductionWeb<span class=\"token punctuation\">.</span><span class=\"token function\">addAlarms</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n  email<span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"youremail@example.com\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div><div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"javascript language-javascript\"><code class=\"javascript language-javascript\"><span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> App<span class=\"token punctuation\">,</span> WebServer<span class=\"token punctuation\">,</span> Database <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"@cloudcamp/aws-runtime\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n&nbsp;\n<span class=\"token keyword\">const</span> app <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">App</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n&nbsp;\n<span class=\"token keyword\">const</span> db <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Database</span><span class=\"token punctuation\">(</span>app<span class=\"token punctuation\">.</span>production<span class=\"token punctuation\">,</span> <span class=\"token string\">\"db\"</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span>\n  engine<span class=\"token operator\">:</span> <span class=\"token string\">\"postgres\"</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n&nbsp;\n<span class=\"token keyword\">const</span> web <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">WebServer</span><span class=\"token punctuation\">(</span>app<span class=\"token punctuation\">.</span>production<span class=\"token punctuation\">,</span> <span class=\"token string\">\"web\"</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span>\n  dockerfile<span class=\"token operator\">:</span> <span class=\"token string\">\"../../Dockerfile\"</span><span class=\"token punctuation\">,</span>\n  port<span class=\"token operator\">:</span> <span class=\"token number\">3000</span><span class=\"token punctuation\">,</span>\n  environment<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span> <span class=\"token constant\">DATABASE_URL</span><span class=\"token operator\">:</span> db<span class=\"token punctuation\">.</span>databaseUrl <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n&nbsp;\nproductionWeb<span class=\"token punctuation\">.</span><span class=\"token function\">addAlarms</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n  email<span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"youremail@example.com\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div><div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"python language-python\"><code class=\"python language-python\"><span class=\"token keyword\">from</span> cloudcamp<span class=\"token punctuation\">.</span>aws_runtime <span class=\"token keyword\">import</span> App<span class=\"token punctuation\">,</span> WebServer<span class=\"token punctuation\">,</span> Database\n&nbsp;\napp <span class=\"token operator\">=</span> App<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n&nbsp;\ndb <span class=\"token operator\">=</span> Database<span class=\"token punctuation\">(</span>app<span class=\"token punctuation\">.</span>production<span class=\"token punctuation\">,</span> <span class=\"token string\">\"db\"</span><span class=\"token punctuation\">,</span>\n    engine<span class=\"token operator\">=</span><span class=\"token string\">\"postgres\"</span>\n<span class=\"token punctuation\">)</span>\n&nbsp;\nweb <span class=\"token operator\">=</span> WebServer<span class=\"token punctuation\">(</span>app<span class=\"token punctuation\">.</span>production<span class=\"token punctuation\">,</span> <span class=\"token string\">\"web\"</span><span class=\"token punctuation\">,</span>\n    dockerfile<span class=\"token operator\">=</span><span class=\"token string\">\"../../Dockerfile\"</span><span class=\"token punctuation\">,</span>\n    port<span class=\"token operator\">=</span><span class=\"token number\">3000</span><span class=\"token punctuation\">,</span>\n    environment<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token string\">\"DATABASE_URL\"</span><span class=\"token punctuation\">:</span> db<span class=\"token punctuation\">.</span>database_url<span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">)</span>\n&nbsp;\nproduction_web<span class=\"token punctuation\">.</span>add_alarms<span class=\"token punctuation\">(</span>\n    email<span class=\"token operator\">=</span><span class=\"token punctuation\">[</span><span class=\"token string\">\"youremail@example.com\"</span><span class=\"token punctuation\">]</span>\n<span class=\"token punctuation\">)</span></code></pre></div><div class=\"gatsby-highlight\" data-language=\"csharp\"><pre class=\"csharp language-csharp\"><code class=\"csharp language-csharp\"><span class=\"token keyword\">using</span> <span class=\"token namespace\">Cloudcamp<span class=\"token punctuation\">.</span>Aws<span class=\"token punctuation\">.</span>Runtime</span><span class=\"token punctuation\">;</span>\n&nbsp;\n<span class=\"token class-name\">App</span> app <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token constructor-invocation class-name\">App</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n&nbsp;\n<span class=\"token class-name\">Database</span> db <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token constructor-invocation class-name\">Database</span><span class=\"token punctuation\">(</span>app<span class=\"token punctuation\">.</span>Production<span class=\"token punctuation\">,</span> <span class=\"token string\">\"db\"</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">new</span> <span class=\"token constructor-invocation class-name\">DatabaseProps</span> <span class=\"token punctuation\">{</span>\n    Engine <span class=\"token operator\">=</span> <span class=\"token string\">\"postgres\"</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n&nbsp;\n<span class=\"token class-name\">WebServer</span> web <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token constructor-invocation class-name\">WebServer</span><span class=\"token punctuation\">(</span>app<span class=\"token punctuation\">.</span>Production<span class=\"token punctuation\">,</span> <span class=\"token string\">\"web\"</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">new</span> <span class=\"token constructor-invocation class-name\">WebServerProps</span> <span class=\"token punctuation\">{</span>\n    Dockerfile <span class=\"token operator\">=</span> <span class=\"token string\">\"../../Dockerfile\"</span><span class=\"token punctuation\">,</span>\n    Port <span class=\"token operator\">=</span> <span class=\"token number\">3000</span><span class=\"token punctuation\">,</span>\n    Environment <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token constructor-invocation class-name\">Dictionary<span class=\"token punctuation\">&lt;</span><span class=\"token keyword\">string</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">string</span><span class=\"token punctuation\">></span></span> <span class=\"token punctuation\">{</span> <span class=\"token punctuation\">{</span> <span class=\"token string\">\"DATABASE_URL\"</span><span class=\"token punctuation\">,</span> db<span class=\"token punctuation\">.</span>DatabaseUrl <span class=\"token punctuation\">}</span> <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n&nbsp;\nproductionWeb<span class=\"token punctuation\">.</span><span class=\"token function\">AddAlarms</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token constructor-invocation class-name\">Struct</span> <span class=\"token punctuation\">{</span>\n    Email <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> <span class=\"token punctuation\">{</span> <span class=\"token string\">\"youremail@example.com\"</span> <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div><div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"java language-java\"><code class=\"java language-java\"><span class=\"token keyword\">import</span> <span class=\"token namespace\">cloudcamp<span class=\"token punctuation\">.</span>aws<span class=\"token punctuation\">.</span>runtime<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">App</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token namespace\">cloudcamp<span class=\"token punctuation\">.</span>aws<span class=\"token punctuation\">.</span>runtime<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">WebServer</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token namespace\">cloudcamp<span class=\"token punctuation\">.</span>aws<span class=\"token punctuation\">.</span>runtime<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">Database</span><span class=\"token punctuation\">;</span>\n&nbsp;\n<span class=\"token class-name\">App</span> app <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">App</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n&nbsp;\n<span class=\"token class-name\">Database</span> db <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Database</span><span class=\"token punctuation\">(</span>app<span class=\"token punctuation\">.</span><span class=\"token function\">getProduction</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"db\"</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">DatabaseProps<span class=\"token punctuation\">.</span>Builder</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">.</span><span class=\"token function\">engine</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"postgres\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">build</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n&nbsp;\n<span class=\"token class-name\">WebServer</span> web <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">WebServer</span><span class=\"token punctuation\">(</span>app<span class=\"token punctuation\">.</span><span class=\"token function\">getProduction</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"web\"</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">WebServerProps<span class=\"token punctuation\">.</span>Builder</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">.</span><span class=\"token function\">dockerfile</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"../../Dockerfile\"</span><span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">.</span><span class=\"token function\">port</span><span class=\"token punctuation\">(</span><span class=\"token number\">3000</span><span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">.</span><span class=\"token function\">environment</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Map</span><span class=\"token punctuation\">.</span><span class=\"token function\">of</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"DATABASE_URL\"</span><span class=\"token punctuation\">,</span> db<span class=\"token punctuation\">.</span><span class=\"token function\">getDatabaseUrl</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">build</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n&nbsp;\nproductionWeb<span class=\"token punctuation\">.</span><span class=\"token function\">addAlarms</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Map</span><span class=\"token punctuation\">.</span><span class=\"token function\">of</span><span class=\"token punctuation\">(</span>\n        <span class=\"token string\">\"email\"</span><span class=\"token punctuation\">,</span> <span class=\"token function\">asList</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"youremail@example.com\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>Now update the app - you know the drill.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">$ <span class=\"token function\">git</span> <span class=\"token function\">add</span> -A <span class=\"token operator\">&amp;&amp;</span> <span class=\"token function\">git</span> commit -m <span class=\"token string\">\"add monitoring\"</span> <span class=\"token operator\">&amp;&amp;</span> <span class=\"token function\">git</span> push\n$ camp status --wait --notify</code></pre></div>\n<p>Visit <code class=\"language-text\">/error</code> again, and you will get an email notification that something went\nwrong. Neat.</p>\n<h1>Custom domain (Optional)</h1>\n<p>Domains and certificates have to be added via the command line before being used. Use\n<code class=\"language-text\">domain:create</code> to set up a domain:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">$ camp domain:create yourdomain.com\n\n Nameservers\n ───────────────────────\n ns-1320.awsdns-37.org\n ns-999.awsdns-60.net\n ns-1838.awsdns-37.co.uk\n ns-72.awsdns-09.com\n\n › To request a certificate, run <span class=\"token variable\"><span class=\"token variable\">`</span>camp cert:create yourdomain.com<span class=\"token variable\">`</span></span>\n\nDomain created: yourdomain.com</code></pre></div>\n<p>Now change the settings of your domain to point to the nameservers in the\ncommand output.</p>\n<p>Once this is done, you can request a certificate.</p>\n<p>(Note that this might take a couple of minutes to complete):</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">$ camp cert:create yourdomain.com\n\nCreating new certificate<span class=\"token punctuation\">..</span>. <span class=\"token keyword\">done</span>\nWaiting <span class=\"token keyword\">for</span> certificate validation<span class=\"token punctuation\">..</span>. <span class=\"token keyword\">done</span>\nCertificate created: yourdomain.com</code></pre></div>\n<p>Finally, update the source code:</p>\n<div class=\"gatsby-highlight\" data-language=\"ts\"><pre class=\"ts language-ts\"><code class=\"ts language-ts\"><span class=\"token keyword\">let</span> productionWeb <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">WebServer</span><span class=\"token punctuation\">(</span>app<span class=\"token punctuation\">.</span>production<span class=\"token punctuation\">,</span> <span class=\"token string\">\"web\"</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// ⬇ add your domain</span>\n  domains<span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"yourdomain.com\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n  <span class=\"token comment\">// ⬇ enable https</span>\n  ssl<span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\n  <span class=\"token comment\">// ⬇ redirect http to https</span>\n  redirectHttp<span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\n  <span class=\"token comment\">// ...</span>\n  dockerfile<span class=\"token operator\">:</span> <span class=\"token string\">\"../../Dockerfile\"</span><span class=\"token punctuation\">,</span>\n  port<span class=\"token operator\">:</span> <span class=\"token number\">3000</span><span class=\"token punctuation\">,</span>\n  environment<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span> <span class=\"token constant\">DATABASE_URL</span><span class=\"token operator\">:</span> productionDb<span class=\"token punctuation\">.</span>databaseUrl <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div><div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"javascript language-javascript\"><code class=\"javascript language-javascript\"><span class=\"token keyword\">let</span> productionWeb <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">WebServer</span><span class=\"token punctuation\">(</span>app<span class=\"token punctuation\">.</span>production<span class=\"token punctuation\">,</span> <span class=\"token string\">\"web\"</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// ⬇ add your domain</span>\n  domains<span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"yourdomain.com\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n  <span class=\"token comment\">// ⬇ enable https</span>\n  ssl<span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\n  <span class=\"token comment\">// ⬇ redirect http to https</span>\n  redirectHttp<span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\n  <span class=\"token comment\">// ...</span>\n  dockerfile<span class=\"token operator\">:</span> <span class=\"token string\">\"../../Dockerfile\"</span><span class=\"token punctuation\">,</span>\n  port<span class=\"token operator\">:</span> <span class=\"token number\">3000</span><span class=\"token punctuation\">,</span>\n  environment<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span> <span class=\"token constant\">DATABASE_URL</span><span class=\"token operator\">:</span> productionDb<span class=\"token punctuation\">.</span>databaseUrl <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div><div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"python language-python\"><code class=\"python language-python\">production_web <span class=\"token operator\">=</span> WebServer<span class=\"token punctuation\">(</span>app<span class=\"token punctuation\">.</span>production<span class=\"token punctuation\">,</span> <span class=\"token string\">\"web\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token comment\"># ⬇ add your domain</span>\n    domains<span class=\"token operator\">=</span><span class=\"token punctuation\">[</span><span class=\"token string\">\"yourdomain.com\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n    <span class=\"token comment\"># ⬇ enable https</span>\n    ssl<span class=\"token operator\">=</span><span class=\"token boolean\">True</span><span class=\"token punctuation\">,</span>\n    <span class=\"token comment\"># ⬇ redirect http to https</span>\n    redirect_http<span class=\"token operator\">=</span><span class=\"token boolean\">True</span><span class=\"token punctuation\">,</span>\n    <span class=\"token comment\"># ...</span>\n    dockerfile<span class=\"token operator\">=</span><span class=\"token string\">\"../../Dockerfile\"</span><span class=\"token punctuation\">,</span>\n    port<span class=\"token operator\">=</span><span class=\"token number\">3000</span><span class=\"token punctuation\">,</span>\n    environment<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token string\">\"DATABASE_URL\"</span><span class=\"token punctuation\">:</span> production_db<span class=\"token punctuation\">.</span>database_url<span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">)</span></code></pre></div><div class=\"gatsby-highlight\" data-language=\"csharp\"><pre class=\"csharp language-csharp\"><code class=\"csharp language-csharp\"><span class=\"token class-name\">WebServer</span> productionWeb <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token constructor-invocation class-name\">WebServer</span><span class=\"token punctuation\">(</span>app<span class=\"token punctuation\">.</span>Production<span class=\"token punctuation\">,</span> <span class=\"token string\">\"web\"</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">new</span> <span class=\"token constructor-invocation class-name\">WebServerProps</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// ⬇ add your domain</span>\n    Domains <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> <span class=\"token punctuation\">{</span> <span class=\"token string\">\"yourdomain.com\"</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token comment\">// ⬇ enable https</span>\n    Ssl <span class=\"token operator\">=</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\n    <span class=\"token comment\">// ⬇ redirect http to https</span>\n    RedirectHttp <span class=\"token operator\">=</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\n    <span class=\"token comment\">// ...</span>\n    Dockerfile <span class=\"token operator\">=</span> <span class=\"token string\">\"../../Dockerfile\"</span><span class=\"token punctuation\">,</span>\n    Port <span class=\"token operator\">=</span> <span class=\"token number\">3000</span><span class=\"token punctuation\">,</span>\n    Environment <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token constructor-invocation class-name\">Dictionary<span class=\"token punctuation\">&lt;</span><span class=\"token keyword\">string</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">string</span><span class=\"token punctuation\">></span></span> <span class=\"token punctuation\">{</span> <span class=\"token punctuation\">{</span> <span class=\"token string\">\"DATABASE_URL\"</span><span class=\"token punctuation\">,</span> productionDb<span class=\"token punctuation\">.</span>DatabaseUrl <span class=\"token punctuation\">}</span> <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div><div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"java language-java\"><code class=\"java language-java\"><span class=\"token class-name\">WebServer</span> productionWeb <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">WebServer</span><span class=\"token punctuation\">(</span>app<span class=\"token punctuation\">.</span><span class=\"token function\">getProduction</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"web\"</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">WebServerProps<span class=\"token punctuation\">.</span>Builder</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">build</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n        <span class=\"token comment\">// ⬇ add your domain</span>\n        <span class=\"token punctuation\">.</span><span class=\"token function\">domains</span><span class=\"token punctuation\">(</span><span class=\"token function\">asList</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"yourdomain.com\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n        <span class=\"token comment\">// ⬇ enable https</span>\n        <span class=\"token punctuation\">.</span><span class=\"token function\">ssl</span><span class=\"token punctuation\">(</span><span class=\"token boolean\">true</span><span class=\"token punctuation\">)</span>\n        <span class=\"token comment\">// ⬇ redirect http to https</span>\n        <span class=\"token punctuation\">.</span><span class=\"token function\">redirectHttp</span><span class=\"token punctuation\">(</span><span class=\"token boolean\">true</span><span class=\"token punctuation\">)</span>\n        <span class=\"token comment\">// ...</span>\n        <span class=\"token punctuation\">.</span><span class=\"token function\">dockerfile</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"../../Dockerfile\"</span><span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">.</span><span class=\"token function\">port</span><span class=\"token punctuation\">(</span><span class=\"token number\">3000</span><span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">.</span><span class=\"token function\">environment</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Map</span><span class=\"token punctuation\">.</span><span class=\"token function\">of</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"DATABASE_URL\"</span><span class=\"token punctuation\">,</span> productionDb<span class=\"token punctuation\">.</span><span class=\"token function\">getDatabaseUrl</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>And push your changes:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">$ <span class=\"token function\">git</span> <span class=\"token function\">add</span> -A <span class=\"token operator\">&amp;&amp;</span> <span class=\"token function\">git</span> commit -m <span class=\"token string\">\"add custom domain\"</span> <span class=\"token operator\">&amp;&amp;</span> <span class=\"token function\">git</span> push\n$ camp status --wait --notify</code></pre></div>\n<p>Now, your app will be running under your custom domain.</p>\n<h1>Cleaning up</h1>\n<p>To delete all resources we created during this tutorial, run <code class=\"language-text\">destroy</code> in your camps directory:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">$ camp destroy</code></pre></div>\n<p>CloudCamp will list and upon confirmation destroy all the resources you created.</p>\n<p>If you added a custom domain, use this command to delete the DNS zone:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">$ camp domain:delete yourdomain.com</code></pre></div>"}},"pageContext":{"slug":"tutorial","onThisPage":[{"title":"Clone the tutorial repo","id":"clone-the-tutorial-repo","children":[]},{"title":"Setting up camp","id":"setting-up-camp","children":[]},{"title":"Deploying to AWS","id":"deploying-to-aws","children":[]},{"title":"Infrastructure as Code","id":"infrastructure-as-code","children":[]},{"title":"Making Changes","id":"making-changes","children":[]},{"title":"Setting up monitoring","id":"setting-up-monitoring","children":[]},{"title":"Custom domain (Optional)","id":"custom-domain-optional","children":[]},{"title":"Cleaning up","id":"cleaning-up","children":[]}],"links":{"prev":{"link":"/docs/installation","title":"Installation"}}}},
    "staticQueryHashes": []}